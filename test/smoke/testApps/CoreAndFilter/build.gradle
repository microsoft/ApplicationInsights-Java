apply plugin: "war"

dependencies {
    implementation "com.microsoft.azure:applicationinsights-web:2.2.0" // 0.9.3 is the oldest version with trackDependency()
                                                                       // 2.2.0 is the oldest version with CloudContext
    testImplementation aiCoreJar // the test code (not the app under test) needs a modern core jar (well, at least 1.0.8)
    implementation "com.google.guava:guava:20.0"

    compileOnly "javax.servlet:javax.servlet-api:3.0.1"

    providedRuntime "mysql:mysql-connector-java:5.1.44"

    smokeTestImplementation "com.google.guava:guava:23.0"
    testImplementation "com.google.guava:guava:23.0" // VSCODE intellisense bug workaround
}

war {
    // this is done to remove the version from the archive file name
    // to make span name verification simpler
    archiveFileName = project.name + ".war"
}

ext.testAppArtifactDir = war.destinationDirectory
ext.testAppArtifactFilename = project.name + ".war"

tasks.withType(JavaCompile) {
    options.release.set(8)
}
